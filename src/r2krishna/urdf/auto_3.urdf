<?xml version="1.0" encoding="utf-8"?>
<robot name="r2krishna">

  <link name="base_footprint"/>
  <joint name="base_joint" type="fixed">
    <parent link="base_footprint"/>
    <child link="base_link"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <gazebo>
    <plugin filename="gz-sim-joint-state-publisher-system" name="gz::sim::systems::JointStatePublisher">
      <topic>/joint_states</topic>
      <joint_name>joint_bogieL</joint_name>
      <joint_name>joint_bogieR</joint_name>
      <joint_name>joint_ML</joint_name>
      <joint_name>joint_MR</joint_name>
      <joint_name>joint_BL</joint_name>
      <joint_name>joint_BR</joint_name>
      <joint_name>joint_FL1</joint_name>
      <joint_name>joint_FR1</joint_name>
      <joint_name>joint_tri1_top</joint_name>
      <joint_name>joint_tri1_right</joint_name>
      <joint_name>joint_tri1_left</joint_name>
      <joint_name>joint_tri2_top</joint_name>
      <joint_name>joint_tri2_right</joint_name>
      <joint_name>joint_tri2_left</joint_name>
    </plugin>

    <plugin filename="gz-sim-imu-system" name="gz::sim::systems::Imu">
    </plugin>

    <plugin filename="gz-sim-diff-drive-system" name="gz::sim::systems::DiffDrive">
      <left_joint>joint_MR</left_joint> <right_joint>joint_ML</right_joint> <wheel_separation>0.73</wheel_separation>
      <wheel_radius>0.1</wheel_radius>
      <topic>/cmd_vel</topic>
      <odom_topic>/odom</odom_topic>
      <frame_id>odom</frame_id>
      <child_frame_id>base_footprint</child_frame_id>
      <publish_odom>true</publish_odom>
    </plugin>

    <plugin filename="gz-sim-diff-drive-system" name="gz::sim::systems::DiffDrive">
      <left_joint>joint_BR</left_joint> <right_joint>joint_BL</right_joint> <wheel_separation>0.73</wheel_separation>
      <wheel_radius>0.1</wheel_radius>
      <topic>/cmd_vel</topic>
    </plugin>

    <plugin filename="gz-sim-diff-drive-system" name="gz::sim::systems::DiffDrive">
      <left_joint>joint_FR1</left_joint> <right_joint>joint_FL1</right_joint> <wheel_separation>0.73</wheel_separation>
      <wheel_radius>0.1</wheel_radius>
      <topic>/climb_vel</topic>
    </plugin>
  </gazebo>

  <gazebo reference="link_ML">
    <mu1>10.0</mu1><mu2>10.0</mu2><kp>1000000.0</kp><kd>100.0</kd>
    <minDepth>0.001</minDepth><maxVel>0.0</maxVel>
  </gazebo>
  <gazebo reference="link_MR">
    <mu1>10.0</mu1><mu2>10.0</mu2><kp>1000000.0</kp><kd>100.0</kd>
    <minDepth>0.001</minDepth><maxVel>0.0</maxVel>
  </gazebo>
  <gazebo reference="link_BL">
    <mu1>10.0</mu1><mu2>10.0</mu2><kp>1000000.0</kp><kd>100.0</kd>
    <minDepth>0.001</minDepth><maxVel>0.0</maxVel>
  </gazebo>
  <gazebo reference="link_BR">
    <mu1>10.0</mu1><mu2>10.0</mu2><kp>1000000.0</kp><kd>100.0</kd>
    <minDepth>0.001</minDepth><maxVel>0.0</maxVel>
  </gazebo>
  <gazebo reference="link_FL1">
    <mu1>10.0</mu1><mu2>10.0</mu2><kp>1000000.0</kp><kd>100.0</kd>
    <minDepth>0.001</minDepth><maxVel>0.0</maxVel>
  </gazebo>
  <gazebo reference="link_FR1">
    <mu1>10.0</mu1><mu2>10.0</mu2><kp>1000000.0</kp><kd>100.0</kd>
    <minDepth>0.001</minDepth><maxVel>0.0</maxVel>
  </gazebo>

  <link name="base_link">
    <inertial>
      <origin xyz="0.004 0.013 0.062" rpy="0 0 0" />
      <mass value="17.72" />
      <inertia ixx="0.157" ixy="0.001" ixz="-0.006" iyy="0.199" iyz="0.00004" izz="0.322" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/base.STL" /></geometry>
      <material name=""><color rgba="0.86 0.9 1 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/base.STL" /></geometry>
    </collision>
  </link>

  <link name="imu_link">
    <visual><geometry><box size="0.02 0.02 0.01"/></geometry><material name="red"><color rgba="1 0 0 1"/></material></visual>
    <collision><geometry><box size="0.02 0.02 0.01"/></geometry></collision>
    <inertial><mass value="0.01"/><inertia ixx="0.0001" ixy="0" ixz="0" iyy="0.0001" iyz="0" izz="0.0001"/></inertial>
  </link>
  <joint name="imu_joint" type="fixed"><parent link="base_link"/><child link="imu_link"/><origin xyz="0 0 0.2" rpy="0 0 0"/></joint>
  <gazebo reference="imu_link">
    <sensor name="imu_sensor" type="imu">
      <always_on>1</always_on><update_rate>100</update_rate><visualize>true</visualize><topic>imu</topic><gz_frame_id>imu_link</gz_frame_id>
    </sensor>
  </gazebo>

  <link name="lidar_link">
    <visual><geometry><cylinder radius="0.05" length="0.04"/></geometry><material name="black"><color rgba="0 0 0 1"/></material></visual>
    <collision><geometry><cylinder radius="0.05" length="0.04"/></geometry></collision>
    <inertial><mass value="0.1"/><inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/></inertial>
  </link>
  <joint name="lidar_joint" type="fixed"><parent link="base_link"/><child link="lidar_link"/><origin xyz="0.35 0 -0.125" rpy="0 0 0"/> </joint>
  <gazebo reference="lidar_link">
    <sensor name="lidar" type="lidar"> 
      <pose>0 0 0 0 0 0</pose><topic>/scan</topic><update_rate>10</update_rate><gz_frame_id>lidar_link</gz_frame_id>
      <ray><scan><horizontal><samples>360</samples><resolution>1</resolution><min_angle>-3.14</min_angle><max_angle>3.14</max_angle></horizontal></scan><range><min>0.3</min><max>10.0</max></range></ray>
      <always_on>1</always_on><visualize>true</visualize>
    </sensor>
  </gazebo>

  <link name="link_bogieL">
    <inertial>
      <origin xyz="-0.026 0 -0.145" rpy="0 0 0" />
      <mass value="4.3" />
      <inertia ixx="0.006" ixy="0" ixz="0" iyy="0.009" iyz="0" izz="0.007" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/left_rover_side.STL" /></geometry>
      <material name=""><color rgba="0.86 0.9 1 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/left_rover_side.STL" /></geometry>
    </collision>
  </link>
  <joint name="joint_bogieL" type="revolute">
    <origin xyz="0.15102 -0.30007 -0.086319" rpy="0 0 0" />
    <parent link="base_link" />
    <child link="link_bogieL" />
    <axis xyz="0 1 0" />
    <limit lower="-0.6" upper="0.6" effort="2000.0" velocity="10.0" />
    <dynamics damping="100.0" friction="20.0"/>
  </joint>

  <link name="link_bogieR">
    <inertial>
      <origin xyz="-0.026 0 -0.145" rpy="0 0 0" />
      <mass value="4.3" />
      <inertia ixx="0.006" ixy="0" ixz="0" iyy="0.009" iyz="0" izz="0.007" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/right_rover_side.STL" /></geometry>
      <material name=""><color rgba="0.86 0.9 1 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/right_rover_side.STL" /></geometry>
    </collision>
  </link>
  <joint name="joint_bogieR" type="revolute">
    <origin xyz="0.15102 0.29593 -0.086319" rpy="0 0 0" />
    <parent link="base_link" />
    <child link="link_bogieR" />
    <axis xyz="0 1 0" /> 
    <limit lower="-0.6" upper="0.6" effort="2000.0" velocity="10.0" />
    <dynamics damping="100.0" friction="20.0"/>
  </joint>

  <link name="link_FL1">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="0.7" />
      <inertia ixx="0.0005" ixy="0" ixz="0" iyy="0.0007" iyz="0" izz="0.0002" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/tri_1.STL" /></geometry>
      <material name=""><color rgba="1 1 1 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry><cylinder radius="0.1" length="0.05"/></geometry>
    </collision>
  </link>
  <joint name="joint_FL1" type="revolute"> 
    <origin xyz="0.14714 -0.008 -0.15264" rpy="0 0 0" />
    <parent link="link_bogieL" />
    <child link="link_FL1" />
    <axis xyz="0 1 0" />
    <limit lower="-360" upper="360" effort="1000.0" velocity="100.0" />
  </joint>

  <link name="link_FR1">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="0.7" />
      <inertia ixx="0.0005" ixy="0" ixz="0" iyy="0.0007" iyz="0" izz="0.0002" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/tri_2.STL" /></geometry>
      <material name=""><color rgba="1 1 1 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry><cylinder radius="0.1" length="0.05"/></geometry>
    </collision>
  </link>
  <joint name="joint_FR1" type="revolute"> 
    <origin xyz="0.14714 0.01 -0.15264" rpy="0 0 0" />
    <parent link="link_bogieR" />
    <child link="link_FR1" />
    <axis xyz="0 1 0" />
    <limit lower="-360" upper="360" effort="1000.0" velocity="100.0" />
  </joint>

  <link name="link_ML">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="1.4" />
      <inertia ixx="0.003" ixy="0" ixz="0" iyy="0.005" iyz="0" izz="0.003" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/left_1.STL" /></geometry>
      <material name=""><color rgba="0.25 0.25 0.25 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry><cylinder radius="0.1" length="0.05"/></geometry>
    </collision>
  </link>
  <joint name="joint_ML" type="continuous">
    <origin xyz="-0.1526 -0.008 -0.1471" rpy="0 0 0" />
    <parent link="link_bogieL" />
    <child link="link_ML" />
    <axis xyz="0 1 0" />
  </joint>

  <link name="link_MR">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="1.4" />
      <inertia ixx="0.003" ixy="0" ixz="0" iyy="0.005" iyz="0" izz="0.003" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/right_1.STL" /></geometry>
      <material name=""><color rgba="1 0.94 0.90 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry><cylinder radius="0.1" length="0.05"/></geometry>
    </collision>
  </link>
  <joint name="joint_MR" type="continuous">
    <origin xyz="-0.1526 0.01 -0.1471" rpy="0 0 0" />
    <parent link="link_bogieR" />
    <child link="link_MR" />
    <axis xyz="0 1 0" />
  </joint>

  <link name="link_BL">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="1.4" />
      <inertia ixx="0.003" ixy="0" ixz="0" iyy="0.005" iyz="0" izz="0.003" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/left_2.STL" /></geometry>
      <material name=""><color rgba="1 0.94 0.90 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry><cylinder radius="0.1" length="0.05"/></geometry>
    </collision>
  </link>
  <joint name="joint_BL" type="continuous">
    <origin xyz="-0.2988 -0.30407 -0.2365" rpy="0 0 0" />
    <parent link="base_link" />
    <child link="link_BL" />
    <axis xyz="0 1 0" />
  </joint>

  <link name="link_BR">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="1.4" />
      <inertia ixx="0.003" ixy="0" ixz="0" iyy="0.005" iyz="0" izz="0.003" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry><mesh filename="file:///home/shrizz/r2sim_shrizzv5/ros2_ws/src/r2krishna/meshes/right_2.STL" /></geometry>
      <material name=""><color rgba="0.25 0.25 0.25 1" /></material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707 0 0" />
      <geometry><cylinder radius="0.1" length="0.05"/></geometry>
    </collision>
  </link>
  <joint name="joint_BR" type="continuous">
    <origin xyz="-0.2988 0.30193 -0.2365" rpy="0 0 0" />
    <parent link="base_link" />
    <child link="link_BR" />
    <axis xyz="0 1 0" />
  </joint>

</robot>
